{% load static %}
{% load widget_tweaks %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clubes Disponíveis | Joystick Juice</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <link rel="stylesheet" href="{% static 'css/global/theme.css' %}">

    <link rel="stylesheet" href="{% static 'css/global/base.css' %}">
</head>
<body class="d-flex flex-column" style="min-height: 100vh;">

    <main class="main-content flex-grow-1">

        <div class="page-container mt-4 mb-5">

            <h1 class="mb-4 theme-accent">Clubes Disponíveis</h1>

            <div class="d-flex justify-content-end mb-4">
                <a href="{% url 'create_club' %}" class="btn btn-custom-accent py-2">
                    <i class="fas fa-plus-circle me-2"></i> Criar Novo Clube
                </a>
            </div>

            <hr>

            <div class="club-list row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 mt-3">
            {% for club in clubs %}
                <div class="col">
                    <div class="club-card panel h-100 p-4 d-flex flex-column">

                        <h3 class="mb-2 theme-accent" style="font-size: 1.4rem;">
                            <i class="fas fa-users me-2"></i> {{ club.name }}
                        </h3>

                        <p class="text-muted flex-grow-1">{{ club.description|truncatechars:100 }}</p>

                        <div class="club-meta small mb-3">
                            <p class="mb-1 text-muted">
                                <i class="fas fa-crown me-1" style="color: var(--accent-color);"></i> Criador:
                                <strong>{{ club.creator.username }}</strong>
                            </p>
                            <p class="mb-1 text-muted">
                                <i class="fas fa-user-friends me-1"></i> Membros:
                                <strong>{{ club.members.count }}</strong>
                            </p>
                        </div>

                        <div class="mt-auto d-flex flex-wrap gap-2 pt-3 border-top border-secondary-subtle">

                            <a href="{% url 'club_detail' club.id %}" class="btn btn-custom-outline btn-sm">
                                Ver detalhes
                            </a>

                            {% if request.user == club.creator %}
                                <a href="{% url 'edit_club' club.id %}" class="btn btn-custom-light btn-sm">
                                    <i class="fas fa-edit me-1"></i> Editar
                                </a>
                                <a href="{% url 'delete_club' club.id %}" class="btn btn-custom-danger btn-sm">
                                    <i class="fas fa-trash-alt me-1"></i> Excluir
                                </a>
                            {% elif request.user not in club.members.all %}
                                <a href="{% url 'join_club' club.id %}" class="btn btn-success btn-sm">
                                    <i class="fas fa-sign-in-alt me-1"></i> Entrar
                                </a>
                            {% else %}
                                 <span class="badge text-bg-secondary align-self-center py-2 px-3">
                                    <i class="fas fa-check-circle me-1"></i> Você é membro
                                 </span>
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% empty %}
                <div class="col-12">
                    <div class="alert alert-primary mt-4" role="alert">
                        <i class="fas fa-info-circle me-2"></i> Nenhum clube cadastrado. Crie o primeiro!
                    </div>
                </div>
            {% endfor %}
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>